<!DOCTYPE html>
<html lang="en">
<head>
	<link rel="icon" type="image/png" sizes="16x16" href="/static/favicons/busico.png">
	<link rel="icon" href="../favicon.ico" type="image/x-icon" />
	<!--including introjs.css" -->
	<link href="/static/css/introjs.css" rel="stylesheet" type="text/css">
	<link href="/static/css/index.css" rel="stylesheet" type="text/css">
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-118567294-1"></script>
	<script>
  		window.dataLayer = window.dataLayer || [];
  		function gtag(){dataLayer.push(arguments);}
  		gtag('js', new Date());

  		gtag('config', 'UA-118567294-1');
	</script>

	<title>FastTrack</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	

	<script type=text/javascript>
 	 $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
	</script>
	<style >
		#myInput {
			width: 110%;
			margin-left: 1px;
			margin-right: 5px;
			margin-top: 2px;
			margin-bottom: 2px;
			border-style: solid;
    		border-width: 2px;
    		border-color: orange;
		}

		#myInput2 {
			width: 110%;
			margin-left: 1px;
			margin-right: 5px;
			margin-top: 2px;
			margin-bottom: 2px;
			border-style: solid;
    		border-width: 2px;
    		border-color: orange;
		}
		#feedbackform {
		    color: yellow;
		    font-size: 20px;
		    /*animation-name: example;
		    animation-duration: 1s;
		    animation-iteration-count: infinite;*/
		}

		/*@keyframes example {
		    from {color: Cyan;}
		    to {color: white;}
		}*/
		@media (min-width: 768px) {
		  .navbar-nav.navbar-center {
		    position: absolute;
		    left: 50%;
		    transform: translatex(-50%);
		  }
		}
		#map {
			width: 100%;
			height: 646px;
			background-color: grey;
			border-style: solid;
    		border-width: 5px;
    		border-color: orange;
		}
		
		#legend {
			font-family: Arial, sans-serif;
			background: #fff;
			padding: 10px;
			margin: 10px;
			border: 3px solid #000;
			height: 98px;
			width: 194px;
			/*overflow: auto; */
		}
		#legend h3 {
			margin-top: 0;
			font-size: 15px;
			font-weight: bold;
		}
		#legend img {
			vertical-align: middle;
			height: 25%;
			width: 25%;
		}
		
		#results_body {
			height: 489px;
		    max-height: 489px;
		    overflow-y: scroll;
		    width: 100%;
		}

		#resultsbtn1, #resultsbtn1li1, #resultsbtn1li2, #resultsbtn1li3, #resultsbtn2, #resultsbtn2li1, #resultsbtn2li2, #resultsbtn2li3, #resultsbtn3, #resultsbtn3li1, #resultsbtn3li2, #resultsbtn3li3 {
			display: none;
		}

		.autocomplete {
		  /*the container must be positioned relative:*/
		  position: relative;
		  display: inline-block;
		}
		#panelmain {
			border-color: orange;
			color: orange;
		}
		input {
		  border: 1px solid transparent;
		  background-color: #f1f1f1;
		  padding: 10px;
		  font-size: 16px;
		}
		input[type=text] {
		  background-color: #f1f1f1;
		  width: 100%;
		}

		#calculate {
			width: 110%;
			margin-left: 1px;
			margin-right: 5px;
			margin-top: 2px;
			margin-bottom: 2px;
		}

		/*#calculate {
			border-style: solid;
    		border-width: 5px;
    		border-color: orange;
		}

		#myinput2 {
			width: 100%;
			padding: 10px;
			border-style: solid;
    		border-width: 5px;
    		border-color: orange;
		}*/

		.autocomplete-items {
		  position: absolute;
		  border: 1px solid #d4d4d4;
		  border-bottom: none;
		  border-top: none;
		  z-index: 99;
		  /*position the autocomplete items to be the same width as the container:*/
		  top: 100%;
		  left: 0;
		  right: 0;
		}
		.autocomplete-items div {
		  padding: 10px;
		  cursor: pointer;
		  background-color: #fff; 
		  border-bottom: 1px solid #d4d4d4; 
		}
		.autocomplete-items div:hover {
		  /*when hovering an item:*/
		  background-color: #e9e9e9; 
		}
		.autocomplete-active {
		  /*when navigating through the items using the arrow keys:*/
		  background-color: DodgerBlue !important; 
		  color: #ffffff; 
		}
		.loader {
			display: none;
		    border: 16px solid #f3f3f3; /* Light grey */
		    border-top: 16px solid #3498db; /* Blue */
		    border-radius: 50%;
		    width: 120px;
		    height: 120px;
		    animation: spin 2s linear infinite;
		}

		@keyframes spin {
		    0% { transform: rotate(0deg); }
		    100% { transform: rotate(360deg); }
		}

	</style>
</head>
<body>
	<script src="/static/js/plotroutes.js"></script>

	<script src="/static/js/intro.js"></script>

	<script src="/static/js/starttutorial.js"></script>

<script type="text/javascript">
	function resultsbtnfunction(buttonnum)
	{
		console.log("entered resultsbtnfunction from button with id: " + buttonnum);
		var elemname = "#collapseExample"+buttonnum;
		if ($(elemname).hasClass('in'))
		{
			console.log(buttonnum + " thing was previously collapsed");
			if (order[buttonnum] == 'W')
			{
				//hide walking stuff
				walkingdirectionsDisplay.setMap(null);
	    		walkingmarker1.setVisible(false);
	    		walkingmarker2.setVisible(false);
			}
			else if (order[buttonnum] == 'B')
			{
				//hide first bus stuff
				directionsDisplay.setMap(null);
	    		directionsDisplay2.setMap(null);
	    		bus1marker1.setVisible(false);
	    		bus1marker2.setVisible(false);
	    		bus1marker3.setVisible(false);
	    		bus1marker4.setVisible(false);
	    		line1.setMap(null);
			}
			else if (order[buttonnum] == 'B2')
			{
				//hide sec bus stuff
				directionsDisplay3.setMap(null);
	    		directionsDisplay4.setMap(null);
	    		bus2marker1.setVisible(false);
	    		bus2marker2.setVisible(false);
	    		bus2marker3.setVisible(false);
	    		bus2marker4.setVisible(false);
	    		line2.setMap(null);
			}
		}
		else
		{
			console.log(buttonnum + " thing was previously open");
			if (order[buttonnum] == 'W')
			{
				//open walking stuff
				walkingdirectionsDisplay.setMap(map);
	    		walkingmarker1.setVisible(true);
	    		walkingmarker2.setVisible(true);
			}
			else if (order[buttonnum] == 'B')
			{
				//open first bus stuff
				directionsDisplay.setMap(map);
	    		directionsDisplay2.setMap(map);
	    		bus1marker1.setVisible(true);
	    		bus1marker2.setVisible(true);
	    		bus1marker3.setVisible(true);
	    		bus1marker4.setVisible(true);
	    		line1.setMap(map);

			}
			else if (order[buttonnum] == 'B2')
			{
				//open sec bus stuff
				directionsDisplay3.setMap(map);
	    		directionsDisplay4.setMap(map);
	    		bus2marker1.setVisible(true);
	    		bus2marker2.setVisible(true);
	    		bus2marker3.setVisible(true);
	    		bus2marker4.setVisible(true);
		    	line2.setMap(map);
			}
		}
	}
</script>

	<div class="container-fluid">
		<div class="row">
			<nav class="navbar navbar-inverse" role="navigation">
			  <div class="navbar-header">
			    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
			      <span class="icon-bar"></span>
			      <span class="icon-bar"></span>
			      <span class="icon-bar"></span>
			    </button>    
			  </div>
			  <div class="navbar-collapse collapse">
			    <ul class="nav navbar-nav">
			        <li><a id = "step1" href="https://princetonfasttrack.herokuapp.com/">FastTrack</a></li>
			    </ul>
			    <ul class="nav navbar-nav navbar-center">
			        <li><a href="https://goo.gl/forms/zsNMoEaVVvpxOM1l2" id = "feedbackform">Click to leave your anonymous feedback!</a></li>
			    </ul>
			    <ul class="nav navbar-nav navbar-right">
			    	<li><a href="#" onclick=starttutorial();>FastTrack Tutorial</a></li>
					<li><a href="https://bidotair.github.io/Fast-Track/">About FastTrack</a></li>
				</ul>
			  </div>
			</nav>
		</div>
		<div class="row">
			<div class="col-sm-2">
				<form autocomplete="off" >
				  <div class="autocomplete" style="width:200px;">
				  	<div class="input-group mb-3">
					  <div class="input-group-prepend">
					  </div>
					  <input type="text" id="myInput" class="form-control" placeholder="Using your location" aria-label="Using your location" aria-describedby="basic-addon1">
					</div>

					<div class="input-group mb-3">
					  <div class="input-group-prepend">
					  </div>
					  <input type="text" id="myInput2" class="form-control" placeholder="Enter Destination" aria-label="Enter Destination" aria-describedby="basic-addon1">
					</div>
				    <button id = "calculate" type="button" class="btn btn-warning">Submit</button>
				  </div>			  
				</form>

				<div class="panel  panel-warning" id = "panelmain">
					<div class="panel-heading" overflow: hidden;> <u><b>Results Fastest to Slowest:</b></u></div>
					<div class="panel-body" id = "results_body" max-height: 6;overflow-y: scroll;>
						<div class="loader" id = "loaderelement"></div>
						<button type="button" class="btn btn-primary btn-block" href="#collapseExample0" data-toggle="collapse" id = "resultsbtn1"  onclick="resultsbtnfunction(0)">Block level button</button>
						<div class="collapse" id="collapseExample0">
							<ul class="list-group">
								<li class="list-group-item list-group-item-warning" id = "resultsbtn1li1">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson</li>
								<li class="list-group-item list-group-item-info" id = "resultsbtn1li2">a beer labore wes anderson cred nesciunt sapiente ea proident.</li>
								<li class="list-group-item list-group-item-success" id = "resultsbtn1li3">d squid. Nihil anim keffiyeh helvetica, craft</li>
								
							</ul>
						</div>

						<button type="button" class="btn btn-primary btn-block" href="#collapseExample1" data-toggle="collapse" id = "resultsbtn2"  onclick="resultsbtnfunction(1)">Block level button</button>
						<div class="collapse" id="collapseExample1">
							<ul class="list-group">
								<li class="list-group-item list-group-item-warning" id = "resultsbtn2li1">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson</li>
								<li class="list-group-item list-group-item-info" id = "resultsbtn2li2">a beer labore wes anderson cred nesciunt sapiente ea proident.</li>
								<li class="list-group-item list-group-item-success" id = "resultsbtn2li3">d squid. Nihil anim keffiyeh helvetica, craft</li>
								
							</ul>
						</div>

						<button type="button" class="btn btn-primary btn-block" href="#collapseExample2" data-toggle="collapse" id = "resultsbtn3"  onclick="resultsbtnfunction(2)">Block level button</button>
						<div class="collapse" id="collapseExample2">
							<ul class="list-group">
								<li class="list-group-item list-group-item-warning" id = "resultsbtn3li1">Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson</li>
								<li class="list-group-item list-group-item-info" id = "resultsbtn3li2">a beer labore wes anderson cred nesciunt sapiente ea proident.</li>
								<li class="list-group-item list-group-item-success" id = "resultsbtn3li3">d squid. Nihil anim keffiyeh helvetica, craft</li>
								
							</ul>
						</div>
					</div>
				</div>

            </div>
			<div class="col-sm-10">
				<div id="map"></div>
				<div id="legend"><h3>Legend</h3></div>

				
				
				<script>
					var map;

					function initMap() {
						var uluru = {lat: 40.346481, lng: -74.658138};
				        	map = new google.maps.Map(document.getElementById('map'), {
				        	zoom: 16.2,
				          	center: uluru,
							mapTypeControl: false
				        });

				        var opt = { minZoom: 15, maxZoom: 19};
						map.setOptions(opt);

						var allowedBounds = new google.maps.LatLngBounds(
						     new google.maps.LatLng(40.3149695,-74.6752898), 
						     new google.maps.LatLng(40.3805075,-74.6361918)
						);
						var lastValidCenter = map.getCenter();

						google.maps.event.addListener(map, 'center_changed', function() {
						    if (allowedBounds.contains(map.getCenter())) {
						        // still within valid bounds, so save the last valid position
						        lastValidCenter = map.getCenter();
						        return; 
						    }

						    // not valid anymore => return to last valid position
						    map.panTo(lastValidCenter);
						});


						
						var icons = {
							Route1: {
								name: 'Walk Only Route',
								icon: 'https://raw.githubusercontent.com/bmukadam/Fast-Track/master/PNG%20for%20Legend/GreyDotted.PNG'
							},
							Route2: {
								name: 'Walk Route to Pickup',
								icon: 'https://raw.githubusercontent.com/bmukadam/Fast-Track/master/PNG%20for%20Legend/YellowDotted.PNG'
							},
							Route3: {
								name: 'Bus Route',
								icon: 'https://raw.githubusercontent.com/bmukadam/Fast-Track/master/PNG%20for%20Legend/BlueSolid.PNG'
							},
							Route4: {
								name: 'Walk Route from Dropoff',
								icon: 'https://raw.githubusercontent.com/bmukadam/Fast-Track/master/PNG%20for%20Legend/GreenDotted.PNG'
							}
							
						};
						
						var legend = document.getElementById('legend');
						for (var key in icons) {
							var type = icons[key];
							var name = type.name;
							var icon = type.icon;
							var div = document.createElement('div');
							div.innerHTML = '<img src="' + icon + '"> ' + name;
							legend.appendChild(div);
						}
						map.controls[google.maps.ControlPosition.TOP_LEFT].push(legend);
					}
					
					

			    </script>
			    <script async defer
			    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDpp8voCHf0PvvD46oNJUQCj4xxhvXcN9U&libraries=geometry&callback=initMap">
			    </script>
				<br>
			</div>
		</div>
	</div>
	<script src="/static/js/autocomplete.js"></script>
</body>
</html>
