<!DOCTYPE html>
<html lang="en">
<head>
	<title>FastTrack</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

	<script type=text/javascript>
 	 $SCRIPT_ROOT = {{ request.script_root|tojson|safe }};
	</script>
	<style >
		#map {
			width: 100%;
			height: 667px;
			background-color: grey;
		}
		
		#results_body {
			height: 500px;
		    max-height: 500px;
		    overflow-y: scroll;
		}
		/*
		.col-sm-2 {
			background-color: #DCDCDC;
		}
		body {
			background-color: #DCDCDC;
		}*/
	</style>
</head>
<body>

	<script type="text/javascript">
		var hasline = 0;
		var line;
		$(document).ready(function(){
		    $("#calculate").click(function(){
		    	//alert("Mouse down over p1!");
		    	if (hasline == 1) {
		    		line.setMap(null);
		    		$("#results_body").empty();
		    	}
		    	
		    	$.getJSON($SCRIPT_ROOT + '/FastTrackPython', {
			        src: $('input[name="src"]').val(),
			        dst: $('input[name="dst"]').val()
			      }, function(data) {
			      	alert("Data Length is: " + data.result.length);
			      	alert("Data[0] is: " + data.result[0]);
			      	alert("Data[1] is: " + data.result[1]);
			      	var div = document.getElementById('results_body');
			      	/*for( var i=0; i < data.result.length-1; i++) {
			      		div.innerHTML += data.result[i];
			      		div.innerHTML += "<br><br>";
			      	}*/
			      	div.innerHTML += data.result[0];
			      	div.innerHTML += "<br><br>";
			        //$("#results_body").text(data.result[1]);
			        
					var encoded_data = data.result[1];
			        var decode = google.maps.geometry.encoding.decodePath(encoded_data);
			        line = new google.maps.Polyline({
				        path: decode,
				        strokeColor: '#00008B',
				        strokeOpacity: 1.0,
				        strokeWeight: 4,
				        zIndex: 3
				    });

				    line.setMap(map);
				    hasline = 1;
			      });
			      return false;
		        
		    });
		});		
	</script>
	<!--
	<script type=text/javascript>
	  $(function() {
	    $('a#calculate').bind('click', function() {
	      $.getJSON($SCRIPT_ROOT + '/_add_numbers', {
	        a: $('input[name="a"]').val(),
	        b: $('input[name="b"]').val()
	      }, function(data) {
	        $("#result").text(data.result);
	      });
	      return false;
	    });
	  });
	</script>
-->
	<script>
	function changeText() { 
	    //id.innerHTML = "Was clicked!";
	    var sourcetxt = document.getElementById('usersrcfield').value
	    var desttxt = document.getElementById('userdstfield').value
	    document.getElementById('results_body').innerHTML = sourcetxt + desttxt
	}
	</script>
	<div class="container-fluid">
		<div class="row">
			<nav class="navbar navbar-inverse">
				<div class="container-fluid">
					<div class="navbar-header">
						<a class="navbar-brand" href="https://bidotair.github.io/Fast-Track/">FastTrack</a>
					</div>
					<ul class="nav navbar-nav navbar-right">
						<li><a href="#"><span class="glyphicon glyphicon-user"></span>Username here</a></li>
						<li><a href="#">About FastTrack</a></li>
					</ul>
				</div>
			</nav>
		</div>
		<div class="row">
			<div class="col-sm-2">

				<!--<form action="/FastTrackPython" method="POST">-->
				<form>
					<div class="input-group">
						<span class="input-group-addon"></span>
						<input id="usersrcfield" type="text" class="form-control" name="src" placeholder="Choose Starting Point">
					</div>
					<div class="input-group">
						<span class="input-group-addon"></span>
						<input id="userdstfield" type="text" class="form-control" name="dst" placeholder="Enter Destination">
					</div>
					<button id=calculate>Submit</button>
					<!--<input id=calculate type="submit" class="btn btn-primary">-->
				</form>
				<br>
				<div class="panel panel-default">
					<div class="panel-heading" overflow: hidden;>Results:</div>
					<div class="panel-body" id = "results_body" max-height: 10;overflow-y: scroll;>
						<!--
						{% if route_results %} 
							{{ route_results }}
						{% else %}
							<br><br><br><br><br><br><br><br>
							<br><br><br><br><br><br><br><br>
							<br><br><br><br><br><br><br><br>
						{% endif %}
						-->
					</div>
				</div>
			</div>
			<div class="col-sm-10">
				<div id="map"></div>
				
				<script>
					var map;

					function initMap() {
						var uluru = {lat: 40.346481, lng: -74.658138};
				        map = new google.maps.Map(document.getElementById('map'), {
				        	zoom: 16.2,
				          	center: uluru
				        });
				        /*
				        var encoded_data = 'msguFphsfMpEjWdQ}LdGmEhFkDlB{AlC}B??w@cBk@u@cA_AwB}A]Y}@gAYc@a@_AMa@UeA';

				        var decode = google.maps.geometry.encoding.decodePath(encoded_data);
				        var line = new google.maps.Polyline({
					        path: decode,
					        strokeColor: '#00008B',
					        strokeOpacity: 1.0,
					        strokeWeight: 4,
					        zIndex: 3
					    });

					    line.setMap(map);*/
			      }
			    </script>
			    <script async defer
			    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC945tXFFzfa2r839092cdeRYDR_MFGceg&libraries=geometry&callback=initMap">
			    </script>
			    <!--
				<iframe src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d12163.367045588777!2d-74.6462761!3d40.345856149999996!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sus!4v1523231727703" width="1200" height="650" frameborder="0" style="border:4" allowfullscreen></iframe>
			-->
				<br>
			</div>
		</div>
	</div>

</body>
</html>